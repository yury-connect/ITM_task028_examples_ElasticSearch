# ElasticSearch на примере прилжения поиска фильмов

Проект-демонстрация использования ElasticSearch.

Приложение написано на Java и Spring Boot и использует Maven в качестве средства сборки. 

В репозитории две функциональные ветки:
- `simplesearch`: Содержит пример простого поиска без использования ElasticSearch.
- `elasticsearch`: Содержит пример реализации поиска с помощью ElasticSearch.

При переключении между ветками будет происходить переключение между версиями приложения (без ElasticSearch / с ElasticSearch).

## Требования
- Java 21 и выше
- Maven
- Docker и Docker Compose

## Запуск проекта

### Шаг 1: Построение Docker образа
Для создания Docker образа приложения выполните следующую команду:
```bash
mvn clean compile jib:dockerBuild
```

### Шаг 2: Запуск контейнеров с помощью Docker Compose
Для запуска всех контейнеров, используйте следующую команду:
```bash
docker-compose up
```

### Шаг 3: Индексация документов (для поиска с elasticsearch)
При первом запуске версии с ElasticSearch, необходимо выполнить индексацию всех документов. Для этого перейдите по следующему URL:
http://localhost:8080/reindex

### Доступ к странице поиска
Основная страница с поиском будет доступна по корневому пути:
http://localhost:8080

## Дополнительно
Перед началом работы убедитесь, что у вас установлены все необходимые зависимости и что система соответствует требованиям.
Для успешного выполнения команды docker-compose up убедитесь, что Docker и Docker Compose корректно установлены и настроены.


---

---

---

## Поднимаем локальный EllasticSearch в Docker командой:

#### Вариант 1 _(одной строкой):_
```powershell
docker run -p 9200:9200 -e "discovery.type=single-node" elasticsearch:7.17.22
```

#### Вариант 2 (с переносом строк через `):
```powershell
docker run -p 9200:9200 `
    -e "discovery.type=single-node" `
    elasticsearch:7.17.22
```
> #### Эта команда выполняет следующие действия:
> 1. **Запускает** контейнер `Docker` с образом `Elasticsearch` версии `7.17.22`.
> 2. **Пробрасывает** порт `9200` из контейнера -> на порт `9200` хоста.
> 3. **Устанавливает** переменную окружения `discovery.type=single-node`, 
что означает запуск `Elasticsearch` в режиме **одного узла** _(без кластера)_.

> Сообщение "`Unable to find image 'elasticsearch:7.17.22' locally`" указывает на то, 
> что Docker не смог найти указанный образ локально и попытается загрузить его из репозитория.

```bash
docker run -p 9200:9200 \
-e "discovery.type=single-node" \
elasticsearch:7.17.22
```

### Правильная команда для запуска ElasticSearch в Docker:



